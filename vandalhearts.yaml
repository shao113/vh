
# Note: Matching build requires splat 0.9.1 (or earlier), with sdata.py / sbss.py segtypes added manually.
# Build fails with the newer linker script, possibly due to alignment issues with my mostly arbitrary 
# splits; I'm hoping it will resolve itself as I match more of the gaps between segments.

options:

  platform: psx
  basename: vandalhearts

  base_path: .
  target_path: vandalhearts.psx
  asm_path: asm
  asset_path: assets
  src_path: src

  compiler: GCC

  generated_c_preamble: "#include \"include_asm.h\""
  symbol_addrs_path: symbol_addrs.vandalhearts.txt
  undefined_funcs_auto_path: undefined_funcs_auto.vandalhearts.txt
  undefined_syms_auto_path: undefined_syms_auto.vandalhearts.txt
  find_file_boundaries: True
  enable_ld_alignment_hack: False
  auto_decompile_empty_functions: False
  use_legacy_include_asm: False
  asm_function_macro: glabel
  use_legacy_include_asm: False
  gp_value: 0x80122e10
  auto_all_sections: [".data", ".rodata", ".rdata", ".bss"]
  #linker_discard_section: False
  #migrate_rodata_to_functions: no
  #create_elf_section_list_auto: True
  section_order:
  - .rodata
  - .rdata
  - .text
  - .data
  - .sdata
  - .sbss
  - .bss
segments:
  - [0x0, header]
  - [0x80, bin]
  - type: code
    start: 0x800
    vram: 0x80010000
    subalign: 4
    #align: 4
    subsegments:
    - [0x000800, rdata]                        # 0x80010000

    - [0x0019ec, .rdata, main]                 # 0x800111ec
    - [0x001c04, .rdata, engine]               # 0x80011404
    - [0x001c10, .rdata, projectile]           # 0x80011410
    - [0x001c3c, .rdata, animated_textures]    # 0x8001143c
    - [0x001cdc, .rdata, window]               # 0x800114dc
    - [0x001e48, .rdata, battle_011604]        # 0x80011648
    - [0x001e5c, .rdata, battle_012dcc]        # 0x8001165c
    - [0x001ea0, .rdata, battle_013b94]        # 0x800116a0
    - [0x0023c8, .rdata, battle_0190dc]        # 0x80011bc8
    - [0x002424, rdata]                        # TODO: PathGrid stuff
    - [0x0024d8, .rdata, battle_01f360]        # 0x80011cd8
    - [0x002584, .rdata, battle_0201b8]        # 0x80011d84
    - [0x0030f4, .rdata, split_027dd4]         # 0x800128f4
    - [0x0033ec, .rdata, evt]                  # 0x80012bec
    - [0x003500, .rdata, split_02d078]         # 0x80012d00
    - [0x00353c, .rdata, debug_menu]           # 0x80012d3c
    - [0x0037d4, .rdata, cd]                   # 0x80012fd4
    - [0x003980, .rdata, battle_eval]          # 0x80013180
    - [0x0039a8, .rdata, scene_state_setup]    # 0x800131a8
    - [0x003b24, .rdata, tavern]               # 0x80013324
    - [0x003d50, .rdata, split_037758]         # 0x80013550
    - [0x003f3c, .rdata, ending_screen]        # 0x8001373c
    - [0x003f58, .rdata, split_038148]         # 0x80013758
    - [0x003f88, .rdata, status_window]        # 0x80013788
    - [0x003fd0, .rdata, world_actions]        # 0x800137d0
    - [0x0041d4, .rdata, card]                 # 0x800139d4
    - [0x0041f4, rdata]                        # 0x800139f4

    - [0x005088, .rdata, fx_0506c0]            # 0x80014888
    - [0x0050a4, rdata]

    - [0x006580, .rdata, audio]                # 0x80015d80 
    - [0x0069b0, bin]                          # 0x800161b0 end of audio jtbls

    - [0x007690, c, main]                      # 0x80016e90 main ...
    - [0x0084c0, c, engine]                    # 0x80017cc0 UpdateEngine ...
    - [0x009c44, c, projectile]                # 0x80019444 CalculateProjectileDeltas ...
    - [0x00ae4c, c, animated_textures]         # 0x8001a64c Evtf564_565_566_MapObject_Water ...
    - [0x00b83c, c, window]                    # 0x8001b03c WindowIsOffScreen ...
    - [0x011604, c, battle_011604]             # 0x80020e04 Evtf571_LevelUp ...
    - [0x012dcc, c, battle_012dcc]             # 0x800225cc Evtf027_TargetingSpell
    - [0x013b94, c, battle_013b94]             # 0x80023394 ClearBattlePortraits ...
    - [0x0190dc, c, battle_0190dc]             # 0x800288dc EmbedIntAsSjis ...
    - [0x01bba8, bin]                          # TODO: PathGrid stuff
    - [0x01f360, c, battle_01f360]             # 0x8002eb60 QueueImpededStep ...
    - [0x0201b8, c, battle_0201b8]             # 0x8002f9b8 ShowReceivedItemDialog ...
    - [0x027dd4, c, split_027dd4]              # 0x800375d4 SaveItemIcons ...
    - [0x028814, c, evt]                       # 0x80038014 Evtf581_AudioCommand ...
    - [0x02d078, c, split_02d078]              # 0x8003c878 ClearUnits ...
    - [0x02efe4, c, debug_menu]                # 0x8003e7e4 Evtf414_DebugMenu
    - [0x02f748, c, cd]                        # 0x8003ef48 CDInit ...
    - [0x030c9c, c, battle_eval]               # 0x8004049c PlayBattleBGM ...
    - [0x0335d0, c, scene_state_setup]         # 0x80042dd0 State_SetupScene ...
    - [0x0345f4, c, tavern]                    # 0x80043df4 PlayerHasItem ...
    - [0x037758, c, split_037758]              # 0x80046f58 State_Movie ...
    - [0x037f70, c, ending_screen]             # 0x80047770 State_EndingScreen
    - [0x038148, c, split_038148]              # 0x80047948 CommitPartyStatus ...
    - [0x038b08, c, status_window]             # 0x80048308 Evtf596_StatusWindowMgr ...
    - [0x0394cc, c, world_actions]             # 0x80048ccc ShowConfigMenu ...
    - [0x039e48, c, card]                      # 0x80049648 State_FileSaveScreen ...
    - [0x03c94c, bin]                          # 0x8004c14c (End of card functions) ShowMsgBoxForSprite

    - [0x0506c0, c, fx_0506c0]                 # 8005fec0 Evtf119_Fx_TBD ...
    - [0x054bc8, bin]

    - [0x0a6d54, c, events]                    # 0x800b6554 Evtf417_LoadEvent03 ...
    - [0x0b0480, bin]

    - [0x0b4e60, c, audio]                     # 0x800c4660 SetSeqDataPtr ...
    - [0x0b7ac8, bin]                          # 0x800c72c8 End of audio functions
    
    - [0x0d4dc8, data]                         # 0x800e45c8 Data?

    - [0x0db758, .data, gCharacterNames]       # 0x800eaf58
    - [0x0dc314, data]                         # 0x800ebb14

    - [0x0e1234, .data, engine]                # 0x800f0a34
    - [0x0e1384, .data, glyphs]                # 0x800f0b84
    - [0x0e1ed8, .data, window]                # 0x800f16d8
    - [0x0e1ee4, .data, battle_0190dc]         # 0x800f16e4
    - [0x0e3094, .data, battle_0201b8]         # 0x800f2894
    - [0x0e326c, .data, split_027dd4]          # 0x800f2a6c
    - [0x0e32ec, data]                         # 

    - [0x0e3714, .data, cd]                    # 0x800f2f14
    - [0x0e5a74, .data, battle_eval]           # 0x800f5274
    - [0x0e5be8, .data, split_037758]          # 0x800f53e8
    - [0x0e5d3c, .data, split_038148]          # 0x800f553c
    - [0x0e5d4c, .data, card]                  # 0x800f554c gCardFilePath
    - [0x0e5d60, data]                         # 0x800f5560 gCardFileHeader: part of card.data; omitted because of image data

    - [0x0e76a4, data, portrait_data]          # 0x800f6ea4
    - [0x0e9b58, data]                         # 0x800f9358

    - [0x0ef188, .data, fx_0506c0]             # 0x800fe988
    - [0x0ef3c0, data]
  
    - [0x0f76ec, .data, audio]                 # 0x80106eec
    - [0x0f91d0, data]                         # 0x801089d0 lib data
    - [0x111a5c, bin]                # - TBD - # 
    - [0x111a60, data]               # # # # # # 

    - [0x113610, .sdata, temp_sdata]           # 0x80122e10 trying stuff
    - [0x113628, bin] 

    - [0x113674, .sdata, engine]               # 0x80122e74
    - [0x11367c, .sdata, projectile]           # 0x80122e7c
    - [0x1136b4, .sdata, battle_013b94]        # 0x80122eb4
    - [0x1136c4, .sdata, battle_0201b8]        # 0x80122ec4
    - [0x1136e0, .sdata, cd]                   # 0x80122ee0
    - [0x1136f8, .sdata, tavern]               # 0x80122ef8
    - [0x113700, .sdata, split_037758]         # 0x80122f00
    - [0x113710, bin]

    - [0x113710, .sdata, card]                 # 0x80122f10
    - [0x11372c, sdata]                        # 0x80122f2c

    # TODO: Need to figure out how to handle sbss without messing up order. Currently I just rely on the addresses
    # set through symbol_addrs to override the assembler's placement
    #- [0x113940, .sbss, engine]          # 0x80123140 TODO: .sbss?
    - [0x113940, bin]                     # 0x80123140 TODO: .sbss?

    #- [0x113ab0, .sbss, card]            # 0x801232b0
    #- [0x113ad8, bin]
    #- [0x114fd4, bss]                    # 0x801247d4
    #- [0x1156fc, .bss, audio]            # 0x80124efc
    #- [0x115704, bin]
    #- [0x16d7bc, .bss, card]
    
    #- [0x1d5ac4, bin] # 0x801e52c4 (More functions)
  - [0x1d4e90, bin] #0x801e4690
  - [0x1e7800] # TBD end of file
